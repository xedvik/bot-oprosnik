# Telegram Опросник с Google Sheets

## Особенности
- Автоматическое создание и настройка структуры Google таблицы
- Поддержка вариантов ответов для каждого вопроса
- Возможность ввода своего варианта ответа
- Администрирование через Telegram и Google таблицу
- Сохранение ответов в московском часовом поясе
- Автоматическое восстановление при сбоях
- Подробная статистика ответов
- Гибкая система управления администраторами
- Возможность редактирования и удаления вопросов
- Сброс прохождения опроса для отдельных пользователей

## Административные команды
### Управление вопросами
- `/add_question` - Добавить новый вопрос
- `/edit_question` - Редактировать существующий вопрос
- `/delete_question` - Удалить вопрос
- `/list_questions` - Показать список всех вопросов

### Управление администраторами
- `/add_admin` - Добавить нового администратора
- `/remove_admin` - Удалить администратора
- `/list_admins` - Показать список администраторов

### Управление данными
- `/stats` - Показать статистику опроса
- `/clear_data` - Очистить все ответы и статистику
- `/reset_user` - Сбросить прохождение опроса для пользователя
- `/restart` - Перезапустить бота и обновить структуру опроса

## Настройка бота

### 1. Подготовка Google Sheets
1. Создайте проект в Google Cloud Console
2. Включите Google Sheets API
3. Создайте сервисный аккаунт и скачайте credentials.json
4. Создайте новую Google таблицу
5. Предоставьте доступ сервисному аккаунту к таблице (права редактора)
6. Скопируйте ID таблицы из URL и вставьте в config.py

### 2. Настройка переменных окружения
Создайте файл .env со следующими параметрами:
env
BOT_TOKEN=ваш_токен_бота
SPREADSHEET_ID=id_вашей_таблицы
GOOGLE_CREDENTIALS_FILE=путь_к_credentials.json


### 3. Структура таблицы
Бот автоматически создаст следующие листы:
- "Вопросы с вариантами ответов" - структура опроса
- "Ответы" - ответы пользователей
- "Статистика" - статистика по вариантам ответов
- "Админы" - список администраторов

## Требования
- Python 3.11+
- Docker и Docker Compose
- Доступ к Google Sheets API
- Telegram Bot Token

## Запуск бота
1. Склонируйте репозиторий
2. Создайте файл .env и заполните его параметрами
3. Запустите бота с помощью Docker Compose или start.sh

docker-compose up --build

## Процесс опроса
1. Пользователь начинает опрос командой /start
2. Последовательно отвечает на все вопросы
3. Подтверждает свои ответы
4. Данные сохраняются в таблицу

## Обновление вопросов
1. Отредактируйте вопросы через команды бота или напрямую в таблице
2. Бот автоматически обновит структуру опроса

## Безопасность
- Доступ к административным командам только для авторизованных пользователей
- Защита от повторного прохождения опроса
- Логирование всех действий администраторов
- Безопасное хранение учетных данных через переменные окружения